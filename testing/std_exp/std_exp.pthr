

func bitCast = <{To: Type}> (from: $From) #pub -> To {
	return @bitCast<{From, To}>(from);
}


func numBytes = <{T: Type, INCLUDE_PADDING: Bool}> () #pub -> USize {
	return @numBytes<{T, INCLUDE_PADDING}>();
}

func sizeOf = <{T: Type}> () #pub -> USize {
	return @numBytes<{T, true}>();
}





//////////////////////////////////////////////////////////////////////
// array test

// type Array = struct #pub {
// 	def LENGTH: USize = 3;

// 	func new = (data: [Int:LENGTH] in) -> (output: This) {
// 		output._data = forward data;
// 		return...;
// 	}

// 	func [] = (this, index: USize) -> Int* {
// 		return this._data[index];
// 	}

// 	func [] = (this mut, index: USize) -> Int*mut {
// 		return this._data[index];
// 	}

// 	func data = (this) -> Int* { return this._data.data(); }
// 	func data = (this mut) -> Int*mut { return this._data.data(); }

// 	func size = (this) -> USize { return LENGTH; }


// 	func as = (this) -> [Int:*] {
// 		return new [Int:*](this.data(), this.size());
// 	}



// 	impl @pthr.Iterable {
// 		createIterator = (this) -> ArrIter {
// 			return new ArrIter(&this);
// 		},

// 		createIterator = (this mut) -> MutArrIter {
// 			return new MutArrIter(&this);
// 		},
// 	}

// 	impl @pthr.IterableRT {
// 		createIterator = (this) -> ArrIter {
// 			return new ArrIter(&this);
// 		},

// 		createIterator = (this mut) -> MutArrIter {
// 			return new MutArrIter(&this);
// 		},
// 	}


// 	var _data: [Int:LENGTH];


// 	///////////////////////////////////
// 	// iters

// 	type ArrIter = struct {
// 		func new = (arr: Array*) -> (output: ArrIter) {
// 			output.current = arr.data();
// 			output.last = arr[arr.size() - 1];
// 			return...;
// 		}

// 		func next = (this mut) -> Void {
// 			const new_address: USize = bitCast<{USize}>(this.current) + sizeOf<{Int}>();
// 			this.current = bitCast<{Int*}>(new_address);
// 		}

// 		func get = (this) -> Int* { return copy this.current; }

// 		func atEnd = (this) -> Bool {
// 			return bitCast<{USize}>(this.current) > bitCast<{USize}>(this.last);
// 		}


// 		impl @pthr.Iterator {
// 			next  = next,
// 			get   = get,
// 			atEnd = atEnd,
// 		}

// 		impl @pthr.IteratorRT {
// 			next  = next,
// 			get   = get,
// 			atEnd = atEnd,
// 		}

// 		var current: Int*;
// 		var last: Int*;
// 	}


// 	type MutArrIter = struct {
// 		func new = (arr: Array*mut) -> (output: MutArrIter) {
// 			output.current = arr.data();
// 			output.last = arr[arr.size() - 1];
// 			return...;
// 		}

// 		func next = (this mut) -> Void {
// 			const new_address: USize = bitCast<{USize}>(this.current) + sizeOf<{Int}>();
// 			this.current = bitCast<{Int*mut}>(new_address);
// 		}

// 		func get = (this) -> Int*mut { return copy this.current; }

// 		func atEnd = (this) -> Bool {
// 			return bitCast<{USize}>(this.current) > bitCast<{USize}>(this.last);
// 		}


// 		impl @pthr.MutIterator {
// 			next  = next,
// 			get   = get,
// 			atEnd = atEnd,
// 		}

// 		impl @pthr.MutIteratorRT {
// 			next  = next,
// 			get   = get,
// 			atEnd = atEnd,
// 		}

// 		var current: Int*mut;
// 		var last: Int*mut;
// 	}

// }