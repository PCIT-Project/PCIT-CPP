

interface Iterator = {
	func next = (this mut) #rt -> Void;
	func get = (this mut) #rt  -> RawPtr;
	func atEnd = (this) #rt  -> Bool;
}




type Array = struct {
	type ArrIter = struct {
		func new = (arr: Array*) #rt -> (output: ArrIter) {
			output.arr = copy arr;
			output.index = 0;
			return...;
		}

		func next = (this mut) #rt -> Void {
			this.index += 1;
		}

		func get = (this mut) #rt -> RawPtr {
			return this.arr[this.index] as RawPtr;
		}

		func atEnd = (this) #rt -> Bool {
			return this.index >= 3;
		}

		impl Iterator{
			next  = next,
			get   = get,
			atEnd = atEnd,
		}


		var arr: Array*;
		var index: USize;
	}


	func new = (data: [Int:3] in) -> (output: This) {
		output._data = forward data;
		return...;
	}

	func [] = (this, index: USize) -> Int*| {
		return this._data[index];
	}

	func [] = (this mut, index: USize) -> Int* {
		return this._data[index];
	}


	func iter = (this mut) #rt -> ArrIter {
		return new ArrIter(&this);
	}


	var _data: [Int:3];
}






// func entry = () #entry -> UI8 {
// 	var array = new Array(new [Int:3][1, 2, 3]);

// 	var arr_iter: Array.ArrIter = array.iter();
// 	var count: Int = 0;

// 	var iter: Iterator* = &arr_iter as Iterator*;

// 	while(iter.atEnd() == false){
// 		defer{ iter.next(); }
// 		count += (iter.get() as Int*).*;
// 	}

	
// 	return count as UI8;
// }