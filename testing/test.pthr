// def std = @import("std");


type AtomicRef = struct <{T: Type}> {
	func new = (ptr: T*mut) -> (output: This) {
		output.ptr = copy ptr;
		return...;
	}

	func copy = delete;
	func move = delete;


	func load = <{ORDERING: @pthr.AtomicOrdering = @pthr.AtomicOrdering.SEQ_CST}> (this) -> T {
		return @atomicLoad<{T*, T, ORDERING}>(this.ptr);
	}

	func store = <{ORDERING: @pthr.AtomicOrdering = @pthr.AtomicOrdering.SEQ_CST}> (this, new_val: T in) -> Void {
		@atomicStore<{T*mut, T, ORDERING}>(this.ptr, forward new_val);
	}

	const ptr: T*mut #priv;
}



func entry = () #entry -> UI8 {
	var num: UI8 = 9;

	var num_ref = new AtomicRef<{UI8}>(&num);

	num_ref.store<{@pthr.AtomicOrdering.MONOTONIC}>(12);
	return num_ref.load();
}